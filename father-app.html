<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>爸爸每日運動時間表</title>
  <style>
    body {
      font-family: 'Microsoft JhengHei', 'Helvetica Neue', Arial, sans-serif;
      background-color: #f8f9fa;
      color: #333;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }
    h1, h2 { text-align: center; color: #2c3e50; }
    .record-section {
      background: #e9ecef;
      padding: 15px;
      margin: 0 0 20px 0;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .record-section p { margin: 8px 0; font-size: 1.1em; }
    .tabs {
      display: flex;
      justify-content: center;
      background: #34495e;
      margin-bottom: 20px;
    }
    .tab-button {
      padding: 15px 25px;
      background: #34495e;
      color: white;
      border: none;
      font-size: 1.1em;
      cursor: pointer;
    }
    .tab-button.active {
      background: #27ae60;
    }
    .tab-content {
      display: none;
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin: 0 20px 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .tab-content.active {
      display: block;
    }
    img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      margin: 15px 0;
      display: block;
    }
    .timer-area {
      margin-top: 20px;
      text-align: center;
    }
    .timer-display {
      font-size: 3.5em;
      font-weight: bold;
      color: #e74c3c;
      margin: 20px 0;
    }
    .rest-timer-display {
      font-size: 2.2em;
      color: #3498db;
      margin: 15px 0;
    }
    .count-display {
      font-size: 2em;
      margin: 15px 0;
      color: #2c3e50;
    }
    button {
      padding: 12px 30px;
      font-size: 1.3em;
      margin: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: white;
    }
    .start-btn { background: #27ae60; }
    .stop-btn { background: #c0392b; }
    .reset-all-btn { background: #7f8c8d; margin-top: 30px; }
  </style>
</head>
<body>
  <div class="record-section">
    <h2>今日記錄</h2>
    <p id="today-record">今日尚未完成任何運動。</p>
    <p id="yesterday-record">昨日記錄載入中...</p>
    <button class="reset-all-btn" onclick="resetAll()">全部重設（包括今日記錄）</button>
  </div>

  <div class="tabs">
    <button class="tab-button active" onclick="openTab('knee')">1. 膝蓋抱胸</button>
    <button class="tab-button" onclick="openTab('seated')">2. 坐姿向前彎</button>
    <button class="tab-button" onclick="openTab('bridge')">3. 改版臀橋</button>
  </div>

  <!-- 膝蓋抱胸 -->
  <div id="knee" class="tab-content active">
    <h2 style="text-align:center;">膝蓋抱胸伸展</h2>
    <p style="text-align:center; font-size:1.2em;">每邊保持約25秒，共5次</p>
    <img src="https://images.squarespace-cdn.com/content/v1/5f5e8592d2b0854b18af6975/cd839177-4fec-4260-aa52-b2994bd90a49/knee+to+chest+stretch.jpg?format=1000w" alt="膝蓋抱胸伸展">
    <img src="https://www.verywellhealth.com/thmb/v_FW5Djsqrg2EGKK0AWrFJrD9m0=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-668296954-5e96103d62e04a08a0cfaaa039c2bf26.jpg" alt="膝蓋抱胸示範">

    <div class="timer-area">
      <div class="count-display">剩餘次數： <span id="count-knee">5</span></div>
      <button class="start-btn" onclick="startCountdown('knee')">開始</button>
      <button class="stop-btn" onclick="stopTimer('knee')">停止</button>
      <div class="timer-display" id="timer-knee">00:25</div>
      <div class="rest-timer-display" id="rest-timer-knee">休息：00:30</div>
    </div>
  </div>

  <!-- 坐姿向前彎 -->
  <div id="seated" class="tab-content">
    <h2 style="text-align:center;">坐姿向前彎</h2>
    <p style="text-align:center; font-size:1.2em;">保持約20秒，共5次</p>
    <img src="https://i.ytimg.com/vi/PUVTGBARpoo/maxresdefault.jpg" alt="坐姿向前彎">
    <img src="https://cdn.shopify.com/s/files/1/0078/8715/9367/files/Yoga-Stretch-Seated-Forward-Bend.png?v=1637346396" alt="椅子向前彎">

    <div class="timer-area">
      <div class="count-display">剩餘次數： <span id="count-seated">5</span></div>
      <button class="start-btn" onclick="startCountdown('seated')">開始</button>
      <button class="stop-btn" onclick="stopTimer('seated')">停止</button>
      <div class="timer-display" id="timer-seated">00:20</div>
      <div class="rest-timer-display" id="rest-timer-seated">休息：00:30</div>
    </div>
  </div>

  <!-- 改版臀橋 -->
  <div id="bridge" class="tab-content">
    <h2 style="text-align:center;">改版臀橋</h2>
    <p style="text-align:center; font-size:1.2em;">抬約4秒，共8次</p>
    <img src="https://www.shape.com/thmb/Ts05mjOzOAAJGxPxzbEtvkMRX7w=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/SHP_MTM_Glute-Bridge_3x2-bfe761cd0ffb45e28875198ebed77038.jpg" alt="臀橋">
    <img src="https://images.ctfassets.net/hjcv6wdwxsdz/7KMn9axHkdRmbkoejvkrwo/6699f5ad3ef63ef509cc49fdd43d2a19/bridge-claudia-hold__1_.png?w=1200" alt="改版臀橋">

    <div class="timer-area">
      <div class="count-display">剩餘次數： <span id="count-bridge">8</span></div>
      <button class="start-btn" onclick="startCountdown('bridge')">開始</button>
      <button class="stop-btn" onclick="stopTimer('bridge')">停止</button>
      <div class="timer-display" id="timer-bridge">00:04</div>
      <div class="rest-timer-display" id="rest-timer-bridge">休息：00:30</div>
    </div>
  </div>

  <script>
    // 音效
    const holdEndSound = new Audio('https://www.soundjay.com/buttons/beep-07.mp3'); // 運動結束聲（短促）
    const restEndSound = new Audio('https://www.soundjay.com/buttons/beep-08b.mp3'); // 休息結束聲（較長）

    const intervals = {};
    const restIntervals = {};

    const config = {
      knee: { hold: 25, rest: 30, totalReps: 5 },
      seated: { hold: 20, rest: 30, totalReps: 5 },
      bridge: { hold: 4, rest: 30, totalReps: 8 }
    };

    function openTab(id) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelector(`button[onclick="openTab('${id}')"]`).classList.add('active');
    }

    function startCountdown(id) {
      if (intervals[id]) return;

      let seconds = config[id].hold;
      document.getElementById(`timer-${id}`).textContent = formatTime(seconds);

      intervals[id] = setInterval(() => {
        seconds--;
        document.getElementById(`timer-${id}`).textContent = formatTime(seconds);
        if (seconds <= 0) {
          clearInterval(intervals[id]);
          delete intervals[id];
          holdEndSound.play();
          completeRep(id);
        }
      }, 1000);
    }

    function completeRep(id) {
      let countElem = document.getElementById(`count-${id}`);
      let count = parseInt(countElem.textContent);
      if (count > 1) {
        count--;
        countElem.textContent = count;
        startRestTimer(id);
      } else {
        countElem.textContent = 0;
        recordCompletion(id);
        document.getElementById(`timer-${id}`).textContent = '完成！';
      }
    }

    function startRestTimer(id) {
      let seconds = config[id].rest;
      document.getElementById(`rest-timer-${id}`).textContent = `休息：${formatTime(seconds)}`;

      restIntervals[id] = setInterval(() => {
        seconds--;
        document.getElementById(`rest-timer-${id}`).textContent = `休息：${formatTime(seconds)}`;
        if (seconds <= 0) {
          clearInterval(restIntervals[id]);
          delete restIntervals[id];
          restEndSound.play();
          document.getElementById(`rest-timer-${id}`).textContent = '休息結束！可以開始下一組';
        }
      }, 1000);
    }

    function stopTimer(id) {
      if (intervals[id]) { clearInterval(intervals[id]); delete intervals[id]; }
      if (restIntervals[id]) { clearInterval(restIntervals[id]); delete restIntervals[id]; }
      document.getElementById(`rest-timer-${id}`).textContent = `休息：${formatTime(config[id].rest)}`;
    }

    function formatTime(sec) {
      const m = Math.floor(sec / 60).toString().padStart(2, '0');
      const s = (sec % 60).toString().padStart(2, '0');
      return `${m}:${s}`;
    }

    // 記錄系統
    const exerciseNames = {
      knee: '膝蓋抱胸伸展',
      seated: '坐姿向前彎',
      bridge: '改版臀橋'
    };

    function getTodayKey() {
      const now = new Date();
      return `exerciseRecord_${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;
    }

    function getYesterdayKey() {
      const yesterday = new Date();
      yesterday.setDate(yesterday.getDate() - 1);
      return `exerciseRecord_${yesterday.getFullYear()}-${String(yesterday.getMonth() + 1).padStart(2, '0')}-${String(yesterday.getDate()).padStart(2, '0')}`;
    }

    function recordCompletion(id) {
      let todayRecord = JSON.parse(localStorage.getItem(getTodayKey())) || [];
      if (!todayRecord.includes(id)) {
        todayRecord.push(id);
        localStorage.setItem(getTodayKey(), JSON.stringify(todayRecord));
      }
      updateRecords();
    }

    function updateRecords() {
      const todayRecord = JSON.parse(localStorage.getItem(getTodayKey())) || [];
      const yesterdayRecord = JSON.parse(localStorage.getItem(getYesterdayKey())) || [];

      document.getElementById('today-record').textContent = todayRecord.length > 0
        ? `今日已完成：${todayRecord.map(id => exerciseNames[id]).join('、')}`
        : '今日尚未完成任何運動。';

      document.getElementById('yesterday-record').textContent = yesterdayRecord.length > 0
        ? `昨日完成：${yesterdayRecord.map(id => exerciseNames[id]).join('、')}`
        : '昨日沒有記錄。';
    }

    function resetAll() {
      if (confirm('確定要重設所有次數及今日記錄？')) {
        localStorage.removeItem(getTodayKey());
        ['knee', 'seated', 'bridge'].forEach(id => {
          document.getElementById(`count-${id}`).textContent = config[id].totalReps;
          document.getElementById(`timer-${id}`).textContent = formatTime(config[id].hold);
          document.getElementById(`rest-timer-${id}`).textContent = `休息：${formatTime(config[id].rest)}`;
          stopTimer(id);
        });
        updateRecords();
      }
    }

    window.onload = function() {
      updateRecords();
      // 初始化顯示正確時間
      document.getElementById('timer-knee').textContent = '00:25';
      document.getElementById('timer-seated').textContent = '00:20';
      document.getElementById('timer-bridge').textContent = '00:04';
    };
  </script>

  <footer style="text-align:center; margin:40px; color:#777;">
    記住：如果不舒服就停，之後畀物理治療師睇。<br>
    祝爸爸早日舒服啲！❤️
  </footer>
</body>
</html>
